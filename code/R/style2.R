
# -----extract comp. keywords, write to file
compKeys <- list()

for (i in 1:length(compLst)){
  cv <- c()
  if(length(compLst[[i]])!= 0){
  cmp <- compLst[[i]]
  
  for(j in 1:length(cmp)){
   cv <- c(cv,cmp[[j]][[1]][[1]])
   }}
compKeys[[i]] <- cv
}

docComps <- list()

for (i in 1:length(docLst)){
  cd <- c()
  if(length(docLst[[i]])!= 0){
    doc <- docLst[[i]]
    
    for(j in 1:length(doc)){
      cd <- c(cd,doc[[j]][[1]][[1]])
    }}
  docComps[[i]] <- cd
}



sink("compKeys.txt")
for(s in 1:length(compLst)){
  
  d <- compKeys[[s]]
  ds <- paste(d,collapse=", ")
  cat("\n")
  cat(s)
  cat("\n")
  cat(ds)
}
for(s in 1:length(docLst)){
  
  d <- docComps[[s]]
  ds <- paste(d,collapse=", ")
  cat("\n")
  cat(names(docLst)[s])
  cat("\n")
  cat(ds)
}




sink()








#----get keywords for each doc 2nd VERSION!!!

docTopics <- list()

for (i in 1:numOfDocs){   # get keywords for each document
  docKeys <- list()
  
  complist <- as.list(docLst[i]) # get component list for each doc
  
  csize <- length(complist[[1]]) # get no of comp for doc
  
  cmplist <- list()
  keylist <- list() # list for keywords 
  for (j in 1:csize){ # for all comp for doc
    
    cmp <- as.integer(complist[[1]][[j]][[1]])  # extract comp no. so we can get keywords and weights 
    compWeight <- as.double(complist[[1]][[j]][[2]]) # extract weight for comp in doc
    
    keyplusweight <-as.list(compLst[cmp]) # get keywords for comp.
    
    keysize <- length(keyplusweight[[1]]) # get no. of terms
    compkeys <- list()
    for (l in 1:keysize){
      
      compkey <- keyplusweight[[1]][[l]][[1]] # extract all keys for curr comp
      keyWeight <- as.double(keyplusweight[[1]][[l]][[2]]) # extract weight for key in comp
      keyWeight <- keyWeight*(2*compWeight) # calc importance of key in doc 
     
      if (is.null(keylist[[compkey]])){   # if key not there yet, add to list for doc + weight
        keylist[[compkey]] <- keyWeight   # assign weight to keyword
        }else{
          
          oldWeight <- keylist[[compkey]]  # get previous value
          newWeight <- oldWeight+keyWeight # add additional weight 
          keylist[[compkey]] <- newWeight # assign new value
        }
      
      }
    
 }
  docTopics[[docnames[i]]] <- keylist
  
}


#--------------write to output file

sink("outfile.txt")
for(s in 1:numOfDocs){
  
  d <- docTopics_short[[s]]
  ds <- paste(names(d),collapse=", ")
  cat("\n")
  cat(docnames[s])
  cat("\n")
  cat(ds)
}
sink()




